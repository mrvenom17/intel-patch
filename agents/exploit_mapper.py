from agents.base_agent import TaskAgent

class ExploitMapperAgent(TaskAgent):
    def __init__(self, model):
        super().__init__(model, role="Exploit Mapping Analyst")

    def process(self, cve_data):
        prompt = f"""
        Check if public exploits exist for this CVE:

        Input: {cve_data}

        Output JSON format:
        {{
          "exploit_exists": true,
          "exploit_link": "https://...",
          "poc_available": true
        }}
        """
        return self.model.invoke(prompt)